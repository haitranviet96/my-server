name: Checkout and prepare

inputs:
  service_name:
    description: 'The name of the service'
    required: true

env:
  MACHINE: daimo-dc

runs:
  using: "composite"
  steps:
    - name: List files in the repository
      env:
        service_name: ${{ inputs.service_name }}
      shell: bash
      run: |
        cd services/${{ inputs.service_name }}
        ls ${{ github.workspace }}

    - name: Tailscale
      uses: tailscale/github-action@v2
      with:
        oauth-client-id: ${{ secrets.TS_OAUTH_CLIENT_ID }}
        oauth-secret: ${{ secrets.TS_OAUTH_SECRET }}
        tags: tag:ci
